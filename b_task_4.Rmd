---
title: ''
author: ''
---

## Task on slide 343



With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

```{r}

source("func/func_drug_conc.R")
out_all <- NULL
r2_seq <- seq(1/10, 1/8, 0.005)
for(r2 in r2_seq){
    out <- deSolve::ode(
            y = c("x" = 1, "y" = 0), times = seq(1, 40, 0.01), func = func_drug_conc,
            parms = c("r1" = 1/3, "r2" = r2), method = "euler"
    )
    out_all <- cbind(out_all, out)
}

summary(out_all)
summary(out)


plot(x ~ time, data= out_all, type = "l")
#lines(x = out_all[, "time"], y = out_all[, 3])
# lines(x = out_all[, "time"], y = out_all[, 6]) #since every y line is after every 3 coloumns you put ii * 3, which is more easier than putting lines y out_all [ ,3/6/9/]
for(ii in seq_along(r2_seq)) {
    lines(x = out_all[, "time"], y = out_all[, ii * 3]) 
}
 
#e.g. to get a range for the day 20, find row 20 get all the values of x and y and get the range
```

---
title: 'Task 4'
author: 'Selina Xing'
---

## Task on slide 343

With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

```{r}

func_drug_conc <- function(t, state, parms) {
    with(as.list(c(state, parms)), {
        dx <- -r1 * x
        dy <- r1 * x - r2 * y
        return(list(c(dx, dy)))
    })
}

if (TRUE) {
    library("deSolve")
    
    r2_values <- seq(1/8, 1/10, length.out = 10)
    
    plot(NA, xlim = c(0, 50), ylim = c(0, 1),  
         xlab = "Time", ylab = "Concentration", 
         main = "Drug Concentration with Different r2 Values")
    
    colors <- rainbow(length(r2_values))
    
    for (i in 1:length(r2_values)) {
        out <- deSolve::ode(
            y = c("x" = 1, "y" = 0),
            times = seq(0, 50, 0.1),
            func = func_drug_conc,
            parms = c("r1" = 1/3, "r2" = r2_values[i])
        )
        lines(out[, "time"], out[, "x"], col = colors[i], lwd = 2, lty = 1)
        lines(out[, "time"], out[, "y"], col = colors[i], lwd = 2, lty = 2)
    }
    
    legend("topright", 
           legend = c(paste("r2 =", round(r2_values, 3), "(x)"),
                     paste("r2 =", round(r2_values, 3), "(y)")),
           col = rep(colors, 2), 
           lwd = 2, 
           lty = rep(c(1, 2), each = length(r2_values)),
           cex = 0.6)  

}
```

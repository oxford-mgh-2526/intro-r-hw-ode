---
title: 'Task on slide 343'
author: 'Can Wang'
---

## Task on slide 343

With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

```{r}
rm(list = ls())
library(deSolve)

X0 <- 1    
Y0 <- 0


R1 <- 1 / 3
R2_values <- c(1/8, 1/9, 1/10) 

T_LAST <- 40
T_INTR <- 0.01
tps <- seq(0, T_LAST, by = T_INTR)

Drug1 <- function(t, state, parms) {
  dx <- -parms["r1"] * state["x"]
  dy <- parms["r1"] * state["x"] - parms["r2"] * state["y"]
  return(list(c(dx, dy)))
}

init_state <- c(x = X0, y = Y0)

colors <- c("red", "blue", "darkgreen")

plot(0, 0, type = "n", xlim = c(0, T_LAST), ylim = c(0, 1),
     xlab = "Time (t)", ylab = "Concentration",
     main = "x(t) and y(t) for different R2 values")

for (i in seq_along(R2_values)) {
  parms <- c(r1 = R1, r2 = R2_values[i])
  out <- as.data.frame(ode(y = init_state, times = tps, func = Drug1, parms = parms))
  
  #  x(t)
  lines(out$time, out$x, col = "lightpink", lwd = 2, lty = 1)
  #  y(t)
  lines(out$time, out$y, col = colors[i], lwd = 2, lty = 2)
}

legend("topright",
       legend = c(paste0("x(t), R2 = ", round(R2_values, 3)),
                  paste0("y(t), R2 = ", round(R2_values, 3))),
       col = rep(colors, each = 2),
       lty = rep(c(1, 2), times = length(R2_values)),
       lwd = 2, bty = "n")
```

---
title: ''
author: ''
---

## Task on slide 343

With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

```{r}
func_drug_conc <- function(t, state, parms) {
    dx <- -parms["r1"] * state["x"]
    dy <- parms["r1"] * state["x"] - parms["r2"] * state["y"]
    return(list(c(dx,dy)))
}

for(i in seq(1/10,1/8,0.001)) {
    out <- deSolve::ode(
        y = c("x" = 1, "y" = 0), times = seq(1, 40, 0.01), func = func_drug_conc,
        parms = c("r1" = 1/2, "r2" = i), method = "euler"
    )
    if(i == 1/10){
        plot(x ~ time, data = out, type = "l")
    }
    lines(y ~ time, data = out)

}

```

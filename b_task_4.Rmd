---
title: ''
author: 'Joseph Kalibbala'
---

## Task on slide 343

With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

```{r}
source(file = file.path("func", "func_drug_conc.R"))

seq_r2 <- seq(from = 1/10, to =  1/8, by = 0.004)
out_all <- NULL
for (ii in seq_along(seq_r2)) {
    out <- deSolve::ode(
        y = c("x" = 1, "y" = 0), times = seq(1, 40, 0.01), func = func_drug_conc,
        parms = c("r1" = 1/2, "r2" = seq_r2[ii]), method = "euler"
    )
    out_all <- cbind(out_all, out[, "y"])
}

head(out_all)

plot(x = out[, "time"], y = out[, "x"], type = "l",
     xlab = "Time", ylab = "Concentration (y)",
     main = "Drug concentration for different r2 values")

for (ii in seq_along(seq_r2)) {
  lines(x = out[, "time"], y = out_all[, ii], col = ii)
}

legend("topright", legend = round(seq_r2, 3),
       col = seq_along(seq_r2), lty = 1, cex = 0.8, title = "r2 values")
```

---
title: ''
author: ''
---

## Task on slide 343

With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

```{r}
library(deSolve)

func_drug_conc <- function(t, state, parms) {
    x <- state["x"]
    y <- state["y"]
    r1 <- parms["r1"]
    r2 <- parms["r2"]
    
    dx <- -r1 * x
    dy <-  r1 * x - r2 * y
    
    return(list(c(dx, dy)))
}

init  <- c(x = 1, y = 0)
times <- seq(0, 40, 0.01)


r1 <- 1/3
r2_vals <- runif(5, min = 1/10, max = 1/8)  


plot(0, 0, type = "n", xlim = c(0, 40), ylim = c(0, 1),
     xlab = "Time", ylab = "Peripheral concentration (y)",
     main = "Uncertainty in r2 (uniform between 1/10 and 1/8)")


for (r2 in r2_vals) {
    parms <- c(r1 = r1, r2 = r2)
    out <- deSolve::ode(y = init, times = times, func = func_drug_conc, parms = parms, method = "euler")
    
    lines(out[, "time"], out[, "y"], col = rgb(0.1, 0.3, 0.8, 0.4))
}

                 
```

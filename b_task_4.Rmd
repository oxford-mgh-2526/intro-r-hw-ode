---
title: ''
author: ''
---

## Task on slide 343

With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

```{r}
source("func/func_drug_conc.R")
y_0 <- c("x" = 1, "y" = 0)
r_1 <- 1/3
r_2_values <- seq(1/8, 1/10, length.out = 10)  
results <- list()
for (i in seq_along(r_2_values)) {
  out <- deSolve::ode(y = y_0, times = seq(1, 40, 0.01), func = func_drug_conc,
                     parms = c("r1" = r_1, "r2" = r_2_values[i]), method = "euler")
  results[[i]] <- data.frame(out, r2 = r_2_values[i])
}

# Plot results for different r2 values
plot(NULL, xlim = c(1, 40), ylim = c(0, 1), xlab = "Time", ylab = "Concentration",
     main = "Drug Concentration Model for different r2 values")
colors <- rainbow(length(r_2_values))
for (i in seq_along(results)) {
  lines(x ~ time, data = results[[i]], col = colors[i], lty = 1)
  lines(y ~ time, data = results[[i]], col = colors[i], lty = 2)
}
legend("topright", legend = paste("r2 =", round(r_2_values, 4)),
       col = colors, lty = 1, cex = 0.8)

```

---
title: ''
author: ''
---

## Task on slide 343

With the function you defined in `func_drug_conc.R`, run the drug concentration
model with `r2` taking values uniformly between 1/8 and 1/10, and plot the results.

This is for step 1 of solving the ODE
```{r}
#' dx/dt = -r1 * x
#' dy/dt = r1 * x - r2 * y
#' This function is designed to work with the deSolve::ode function
source(file.path("func", "func_drug_conc.R")) # This is our function

```

Using deSolve to solve the ODE
```{r}
r2_seq <- seq(1/8, 1/10, by = -0.005)
for (i in r2_seq){
out1 <- deSolve::ode(
    y = c("x" = 1, "y" = 0), times = seq(0, 50, 1), func = func_drug_conc,
    parms = c("r1" = 1/3, "r2" = i), method = "euler"
)
    plot(x ~ time, data = out1, type = "l")
    lines(y ~ time, data = out1)
}
```

